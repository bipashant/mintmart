<%= render 'shared/header'%>
<div class="ch-container">
  <div class="row">
    <%= render 'shared/navigation_menu'%>
    <div id="content" class="col-lg-10 col-sm-10">
      <!-- content starts -->
      <%= render 'shared/breadcumb'%>
      <div class="row">
        <div class="box col-md-12">
          <div class="box-inner">
            <div class="box-header well" data-original-title="">
              <h2><i class="fa fa-sitemap"></i> Purchase Details</h2>
              <div class="box-icon">
                <a href="#" class="btn btn-round btn-default"><i class="glyphicon glyphicon-cog"></i></a>
                <a href="#" class="btn btn-minimize btn-round btn-default"><i
                class="glyphicon glyphicon-chevron-up"></i></a>
                <a href="#" class="btn btn-close btn-round btn-default"><i class="glyphicon glyphicon-remove"></i></a>
              </div>
            </div>
            <div class="box-content">
              <table class="table table-striped table-bordered bootstrap-datatable datatable responsive" id="purchase-table-purchase">
                <thead>
                <tr>
                  <th>Supplier</th>
                  <th>Invoice No.</th>
                  <th>Purchased Date</th>
                  <th>No. of Items</th>
                  <th>Amount</th>
                  <th>Actions</th>
                </tr>
                </thead>
                <tbody>
                    <tr>
                      <td class="center"><%= @purchase.supplier.organization_name %> </td>
                      <td class="center"><%= @purchase.invoice_id %> </td>
                      <td class="center"><%= @purchase.date %> </td>
                      <td class="center" id="item_count"><%= @purchase.items.count %> </td>
                      <td class="center" id="total_amount">NRS <%= @purchase.items.sum(:total) %> </td>
                      <td class="center">

                        <span class="btn btn-success" id ='purchase_add_item_button'><i class="glyphicon glyphicon-zoom-in icon-white"></i> Add Items</span>

                        <%= link_to ' <i class="glyphicon glyphicon-edit icon-white"></i> Update'.html_safe, edit_purchase_path(@purchase),class:'btn btn-info' %>

                      </td>
                    </tr>
                </tbody>
              </table>

            </div>
          </div>
        </div>
      </div>
      <div class="row">
        <div class="box col-md-12">
          <div class="box-inner">
            <div class="box-header well" data-original-title="">
              <h2><i class="fa fa-sitemap"></i> Items List</h2>
              <div class="box-icon">
                <a href="#" class="btn btn-round btn-default"><i class="glyphicon glyphicon-cog"></i></a>
                <a href="#" class="btn btn-minimize btn-round btn-default"><i
                class="glyphicon glyphicon-chevron-up"></i></a>
                <a href="#" class="btn btn-close btn-round btn-default"><i class="glyphicon glyphicon-remove"></i></a>
              </div>
            </div>
            <div class="box-content">

              <div class="col-xs-12 col-md-3 pull-right">
                <div class="xn-search pull-right margin-bottom">
                  <form role="form">
                    <input type="text" name="search" placeholder="Search" id="input-search-items">
                  </form>
                </div>
              </div>
              <div class="col-xs-12 col-md-5 pull-left">
                <div class="status_success margin-bottom" id="status_div_purchase">
                </div>
              </div>
              <table class="table table-striped table-bordered bootstrap-datatable datatable responsive" id = "items-main-table-new" data-source="<%= purchase_path(format: :json) %>">
                <thead>
                <tr>
                  <th>Name</th>
                  <th>Category</th>
                  <th>Unit Price</th>
                  <th>Sell Price</th>
                  <th>Quantity</th>
                  <th>Expiration_date</th>
                  <th>Actions</th>
                </tr>
                </thead>
                <tbody>

                </tbody>
              </table>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>
  <hr>
  <div class="modal fade" id="myModal" tabindex="-1" role="dialog" aria-labelledby="myModalLabel"
       aria-hidden="true">
    <div class="modal-dialog">
      <div class="modal-content">
        <div class="modal-header">
          <button type="button" class="close" data-dismiss="modal">Ã—</button>
        </div>
        <div class="modal-body">
          <div class="box-content">
            <%= form_for(@item) do |f| %>
                <div class="row">
                  <div class="col-md-12">
                    <div class="pull-left col-md-3"><h4>Add Item</h4></div>
                    <div class="col-md-2" id="clear_all_field"><a href="#" class="btn btn-default" >Clear All</a></div>
                    <div class="pull-right col-md-3"><%= f.submit'Register',class: 'btn btn-default',id: 'create-customer-btn' %></div>
                  </div>
                  <div class="box col-md-12">
                    <div class="box-inner col-md-12">
                      <div class="box-content">
                        <div class="row margin-bottom">
                          <div class="col-md-8">
                            <div class="col-md-4">
                              <%= f.label(:item_id,'Item ID') %>
                            </div>
                            <div class="col-md-6">
                              <%= f.text_field :item_id,class: 'form-control',placeholder:' Item ID' %>
                              <span class="help-block text-danger text-danger" id="item_item_id_error"></span>
                            </div>
                            <div class="col-md-2" id="generate_item_id"><a href="#" class="btn btn-default" >Generate</a>
                            </div>
                          </div>
                        </div>
                        <div class="row margin-bottom">
                          <div class="col-md-8">
                            <div class="col-md-4">
                              <%= f.label(:name,'Name') %>
                            </div>
                            <div class="col-md-8">
                              <%= f.text_field :name,class: 'form-control',placeholder:' Name' %>
                              <span class="help-block text-danger text-danger" id="item_name_error"></span>
                            </div>
                          </div>
                        </div>
                        <div class="row margin-bottom">
                          <div class="col-md-8">
                            <div class="col-md-4">
                              <%= f.label(:category_id,'Category') %>
                            </div>
                            <div class="col-md-8">
                              <%= f.select(:category_id, options_from_collection_for_select(@categories, "id", "name"), {prompt: 'Choose Categories'}, {class: 'form-control select'}) %>
                              <span class="help-block text-danger text-danger" id="item_category_id_error"></span>
                            </div>
                          </div>
                        </div>
                        <div class="row margin-bottom">
                          <div class="col-md-8">
                            <div class="col-md-4">
                              <%= f.label(:quantity,'Quantity') %>
                            </div>
                            <div class="col-md-8">
                              <%= f.text_field :quantity,class: 'form-control',placeholder:'Quantity' %>
                              <span class="help-block text-danger text-danger" id="item_quantity_error"></span>
                            </div>
                          </div>
                        </div>
                        <div class="row margin-bottom">
                          <div class="col-md-8">
                            <div class="col-md-4">
                              <%= f.label(:unit_price,'Unit Price') %>
                            </div>
                            <div class="col-md-8">
                              <%= f.text_field :unit_price,class: 'form-control',placeholder:'Unit Price' %>
                              <span class="help-block text-danger text-danger" id="item_unit_price_error"></span>
                            </div>
                          </div>
                        </div>
                        <div class="row margin-bottom">
                          <div class="col-md-8">
                            <div class="col-md-4">
                              <%= f.label(:margin,'Margin') %>
                            </div>
                            <div class="col-md-8">
                              <%= f.text_field :margin,class: 'form-control',placeholder:'Margin' %>
                              <input type="hidden" id="vat_percentage" class="form-control" value="0"></input>
                              <span class="help-block text-danger text-danger" id="item_margin_error"></span>
                            </div>
                          </div>
                        </div>
                        <div class="row margin-bottom">
                          <div class="col-md-8">
                            <div class="col-md-4">
                              <%= f.label(:sell_price,'Sell Price') %>
                            </div>
                            <div class="col-md-6">
                              <%= f.text_field :sell_price,class: 'form-control',placeholder:'Sell Price' %>
                              <span class="help-block text-danger text-danger" id="item_sell_price_error"></span>
                            </div>
                            <div class="col-md-2"><a href="#" class="btn btn-success hide" id="vat_included_div">13% VAT Included</a>
                            </div>
                          </div>
                        </div>
                        <div class="row margin-bottom">
                          <div class="col-md-8">
                            <div class="col-md-4">
                              <%= f.label(:expiration_date,'Expired on') %>
                            </div>
                            <div class="col-md-8">
                              <%= f.text_field :expiration_date,class: 'form-control',placeholder:'Expired on' %>
                              <span class="help-block text-danger text-danger" id="item_expiration_date_error"></span>
                              <%= f.hidden_field :purchase_id, value: @purchase.id %>
                            </div>
                          </div>
                        </div>
                      </div>
                    </div>
                  </div>
                </div>
            <% end %>

          </div>
        </div>

      </div>
    </div>
  </div>
</div><!--/.fluid-container-->

<%= render 'shared/logout_msgbox' %>
<%= render 'shared/confirm_dialogue' %>
