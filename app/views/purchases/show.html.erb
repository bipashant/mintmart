<%= render 'shared/header'%>
<div class="ch-container">
  <div class="row">
    <%= render 'shared/navigation_menu'%>
    <div id="content" class="col-lg-10 col-sm-10">
      <!-- content starts -->
      <%= render 'shared/breadcumb'%>
      <div class="row">
        <div class="box col-md-12">
          <div class="box-inner">
            <div class="box-header well" data-original-title="">
              <h2><i class="fa fa-sitemap"></i> Purchase Details</h2>
              <div class="box-icon">
                <a href="#" class="btn btn-round btn-default"><i class="glyphicon glyphicon-cog"></i></a>
                <a href="#" class="btn btn-minimize btn-round btn-default"><i
                class="glyphicon glyphicon-chevron-up"></i></a>
                <a href="#" class="btn btn-close btn-round btn-default"><i class="glyphicon glyphicon-remove"></i></a>
              </div>
            </div>
            <div class="box-content">
              <table class="table table-striped table-bordered bootstrap-datatable datatable responsive" id="purchase-table">
                <thead>
                <tr>
                  <th>Supplier</th>
                  <th>Purchased Date</th>
                  <th>No. of Items</th>
                  <th>Amount</th>
                  <th>Actions</th>
                </tr>
                </thead>
                <tbody>
                    <tr>
                      <td class="center"><%= link_to @purchase.supplier.organization_name,supplier_path(@purchase.supplier) %> </td>
                      <td class="center"><%= @purchase.date %> </td>
                      <td class="center"><%= @purchase.items.count %> </td>
                      <td class="center"><%= @purchase.amount %> </td>
                      <td class="center">

                        <span class="btn btn-success" id ='purchase_add_item_button'><i class="glyphicon glyphicon-zoom-in icon-white"></i> Add Items</span>

                        <%= link_to ' <i class="glyphicon glyphicon-edit icon-white"></i> Update'.html_safe, edit_purchase_path(@purchase),class:'btn btn-info' %>

                        <%= link_to '<i class="glyphicon glyphicon-trash icon-white"></i> Delete'.html_safe, purchase_path(@purchase), method: :delete, data: { confirm: 'Are you sure?' },class:'btn btn-danger' %>

                      </td>
                    </tr>
                </tbody>
              </table>

            </div>
          </div>
        </div>
      </div>
      <div class="row">
        <div class="box col-md-12">
          <div class="box-inner">
            <div class="box-header well" data-original-title="">
              <h2><i class="fa fa-sitemap"></i> Items List</h2>
              <div class="box-icon">
                <a href="#" class="btn btn-round btn-default"><i class="glyphicon glyphicon-cog"></i></a>
                <a href="#" class="btn btn-minimize btn-round btn-default"><i
                class="glyphicon glyphicon-chevron-up"></i></a>
                <a href="#" class="btn btn-close btn-round btn-default"><i class="glyphicon glyphicon-remove"></i></a>
              </div>
            </div>
            <div class="box-content">

              <div class="col-xs-12 col-md-3 pull-right">
                <div class="xn-search pull-right margin-bottom">
                  <form role="form">
                    <input type="text" name="search" placeholder="Search" id="input-search-items">
                  </form>
                </div>
              </div>
              <table class="table table-striped table-bordered bootstrap-datatable datatable responsive" id="items-table">
                <thead>
                <tr>
                  <th>Name</th>
                  <th>Category</th>
                  <th>Unit Price</th>
                  <th>Quantity</th>
                  <th>Expiration_date</th>
                  <th>Actions</th>
                </tr>
                </thead>
                <tbody>
                <% @purchase.items.each do |item| %>
                    <tr>
                      <td><%=item.name%></td>
                      <td class="center"><%= link_to item.category.name,category_path(item.category) %> </td>
                      <td class="align_right">NRS <%= number_with_precision(item.unit_price, precision: 2) %> </td>
                      <td class="center"><%=item.quantity %> </td>
                      <td class="center"><%=item.expiration_date %> </td>
                      <td class="center">
                        <%= link_to ' <i class="glyphicon glyphicon-zoom-in icon-white"></i> View'.html_safe, item_path(item),class:'btn btn-success' %>
                        <%= link_to ' <i class="glyphicon glyphicon-edit icon-white"></i> Update'.html_safe, edit_item_path(item),class:'btn btn-info' %>
                        <%= link_to '<i class="glyphicon glyphicon-trash icon-white"></i> Delete'.html_safe, item_path(item), method: :delete, data: { confirm: 'Are you sure?' },class:'btn btn-danger' %>
                      </td>
                    </tr>
                <% end %>

                </tbody>
              </table>

            </div>
          </div>
        </div>
      </div>
    </div>
  </div>
  <hr>
  <div class="modal fade" id="myModal" tabindex="-1" role="dialog" aria-labelledby="myModalLabel"
       aria-hidden="true">

    <div class="modal-dialog">
      <div class="modal-content">
        <div class="modal-header">
          <button type="button" class="close" data-dismiss="modal">Ã—</button>
          <h3>Add Items</h3>
        </div>
        <div class="modal-body">
          <div class="box-content">
            <%= form_for(@item) do |f| %>
                <div class="row">
                  <div class="box col-md-12">
                    <div class="box-inner col-md-12">
                      <div class="box-content">
                        <div class="row margin-bottom">
                          <div class="col-md-8">
                            <div class="col-md-4">
                              <%= f.label(:name,'Name') %>
                            </div>
                            <div class="col-md-8">
                              <%= f.text_field :name,class: 'form-control',placeholder:' Name' %>
                            </div>
                          </div>
                        </div>
                        <div class="row margin-bottom">
                          <div class="col-md-8">
                            <div class="col-md-4">
                              <%= f.label(:category_id,'Category') %>
                            </div>
                            <div class="col-md-8">
                              <%= f.select(:category_id, options_from_collection_for_select(@categories, "id", "name"), {prompt: 'Choose Categories'}, {class: 'form-control select'}) %>
                            </div>
                          </div>
                        </div>
                        <div class="row margin-bottom">
                          <div class="col-md-8">
                            <div class="col-md-4">
                              <%= f.label(:quantity,'Quantity') %>
                            </div>
                            <div class="col-md-8">
                              <%= f.number_field :quantity,class: 'form-control',placeholder:'Quantity' %>
                            </div>
                          </div>
                        </div>
                        <div class="row margin-bottom">
                          <div class="col-md-8">
                            <div class="col-md-4">
                              <%= f.label(:unit_price,'Unit Price') %>
                            </div>
                            <div class="col-md-8">
                              <%= f.text_field :unit_price,class: 'form-control',placeholder:'Unit Price' %>
                            </div>
                          </div>
                        </div>
                        <div class="row margin-bottom">
                          <div class="col-md-8">
                            <div class="col-md-4">
                              <%= f.label(:sell_price,'Sell Price') %>
                            </div>
                            <div class="col-md-8">
                              <%= f.text_field :sell_price,class: 'form-control',placeholder:'Sell Price' %>
                            </div>
                          </div>
                        </div>
                        <div class="row margin-bottom">
                          <div class="col-md-8">
                            <div class="col-md-4">
                              <%= f.label(:expiration_date,'Expired on') %>
                            </div>
                            <div class="col-md-8">
                              <%= f.text_field :expiration_date,class: 'form-control',placeholder:'Expired on' %>
                              <%= f.hidden_field :purchase_id, value: @purchase.id %>
                            </div>
                          </div>
                        </div>
                        <div class="row margin-bottom">
                          <div class="col-md-8">
                            <div class="col-md-8">
                            </div>
                            <div class="modal-footer">
                              <a href="#" class="btn btn-default" data-dismiss="modal">Close</a>
                              <%= f.submit'Register',class: 'btn btn-default',id: 'create-customer-btn' %>
                            </div>
                            <div class="col-md-4">

                            </div>


                          </div>
                        </div>

                      </div>
                    </div>
                  </div>
                </div>
            <% end %>

          </div>
        </div>

      </div>
    </div>
  </div>
  <footer class="row">
    <p class="col-md-9 col-sm-9 col-xs-12 copyright">&copy; <a href="#" target="_blank">Mint Mart</a>2015</p>
  </footer>

</div><!--/.fluid-container-->

<%= render 'shared/logout_msgbox' %>
